(self["webpackChunk_canva_web"] = self["webpackChunk_canva_web"] || []).push([[5024],{

/***/ 38406:
function(_, __, __webpack_require__) {__webpack_require__.n_x = __webpack_require__.n;const __web_req__ = __webpack_require__;__web_req__(813110);self._fe4d99ebe0d2d259646a80d250150d47 = self._fe4d99ebe0d2d259646a80d250150d47 || {};(function(__c) {var aJ=__c.aJ;var Lc=__c.Lc;var P=__c.P;var eJ=__c.eJ;var bh=__c.bh;var C=__c.C;var qg=__c.qg;var D=__c.D;var O=__c.O;var Py=__c.Py;
var B5=function(){const [a]=(0,__c.ec)(()=>Py());return a},uIb=function(a){switch(a){case 4:return O("9ND0kg");case 2:return O("ibdecg");case 7:return O("446quA");case 5:return O("j1fbqg");case 1:return O("O5i4AQ");case 6:return O("C0VHsg");case 3:return O("+IXmVg");default:throw new D(a);}},vIb=function(a){return b=>({type:"react",node:(0,__c.N)(a,{...b})})},wIb=function(a){return b=>({type:"dom",render:c=>a(b,c)})},yIb=function(a){var b,c=a.$x,d=a.content;a=a.context;__c.B("formula"===(null===d||
void 0===d?void 0:null===(b=d.eg)||void 0===b?void 0:b.type));b=d.eg.value;switch(b.type){case "invalid":b=b.o$;break;case "canonical":b=b.oJ;break;default:throw new D(b);}__c.B(b.startsWith("="));const e=d.Zt;b={type:"dom",render:h=>h.innerText=""};let f;switch(e.type){case 7:f=b;break;case 1:case 3:case 4:case 2:case 5:case 6:f=xIb(c,a,d.Ty);break;case 0:f={type:"react",node:C5(__c.nS,{label:uIb(e.error),children:C5(__c.sA,{width:"full",display:"flex",justifyContent:"center",children:C5(__c.dmb,
{tone:"critical"})})})};break;default:throw new D(e);}if(!f)return b;c=qg(__c.JQ,a.attrs);d=__c.$I(a.attrs.textAlign,"formula",void 0,()=>e.type);const g={textAlign:__c.HCa(d,c.direction),justifyContent:__c.ICa(d)};switch(f.type){case "dom":return{type:"dom",render:h=>{Object.assign(h.style,g);f.render(h)}};case "react":return{type:"react",node:C5("div",{style:g,children:f.node})};default:throw new D(f);}},xIb=function(a,b,c){var d;return null===(d=a.Dda)||void 0===d?void 0:d.call(a,{context:b,value:c})},
CIb=function(a){const b=a.$x,c=a.Pe;a=a.$cb;b.Dda=zIb;b.tva=d=>yIb({...d,$x:b});b.uva=vIb(AIb({Pe:c,zN:void 0}));b.wva=BIb(a);b.xva=vIb(D5)},DIb=function(a,b,c){const d=[a];for(;null!=a&&a!==b;)(a=c.next(a))&&d.push(a);return d},EIb=function({label:a,width:b,height:c,scale:d,highlight:e,selected:f}){return C5("div",{style:{width:b,height:c,transform:`scale(${d})`},className:"bx74uQ",children:C5(__c.pA,{className:E5({yiml1g:e,oYlhXA:f}),size:"small",alignment:"center",children:a})})},GIb=function({ud:a,
highlight:b,scale:c,ds:d,Sn:e,oQa:f}){const g=F5(()=>{const m=null===d||void 0===d?void 0:d.get();if(null!=m&&0!==m.length)return new __c.QF(m)},[d]),h=e(1),k=e(c),l={ssE9Tg:!a,OkifGQ:a};return C5(__c.qA,{Zo:"light",light:"light",Er:"light",dark:"light",children:m=>C5("div",{className:E5("ze9QCQ",l,m.className),style:{width:k,height:k},children:C5("div",{style:{width:h,height:h,transform:`scale(${c})`},className:E5("N7J3UA",l),ref:null===g||void 0===g?void 0:g.Qk,children:C5(__c.EM,{className:E5("m8CFdg",
l,{G6wL4w:f,W_E0wA:b}),ariaLabel:O("ruWN9A"),children:C5(FIb,{size:"tiny"})})})})})},IIb=function(){const a=new HIb,b=new __c.$T,c=G5(f=>{const {scale:g=1,size:h="small",oQa:k=!0}=f,l=H5(m=>a.Sn(m,h),[h]);return C5(GIb,{...f,scale:g,ud:"rtl"===f.sheet.direction,highlight:null!=f.selection&&a.f4a(f.sheet,f.selection),Sn:l,oQa:k})}),d=G5(f=>{const {scale:g=1,size:h="small"}=f,k=H5(n=>a.Sn(n,h),[h]),l=H5(n=>null!=f.selection&&a.yLa(f.selection).has(n),[f.selection]),m=H5(n=>null!=f.selection&&a.g2a(f.sheet,
f.selection).has(n),[f.sheet,f.selection]);return C5(I5,{...f,scale:g,Sn:k,hEa:l,sMa:m,GD:b})}),e=G5(f=>{const {scale:g=1,size:h="small"}=f,k=H5(n=>a.Sn(n,h),[h]),l=H5(n=>null!=f.selection&&a.ALa(f.selection).has(n),[f.selection]),m=H5(n=>null!=f.selection&&a.h2a(f.sheet,f.selection).has(n),[f.sheet,f.selection]);return C5(J5,{...f,scale:g,Sn:k,tMa:m,DEa:l,GD:b})});return{OQa:c,NQa:d,PQa:e}},JIb=function(a){const b=a.rr,c=()=>null;return __c.az(d=>C5(K5,{...d,rr:b,Yh:c}))},LIb=function({sheet:a,scaleFactor:b,
range:c,xd:d,UDa:e}){KIb(()=>L5(()=>{if(null!=d.current&&null!=e.current){var f,g=null!==(f=null===b||void 0===b?void 0:b.get())&&void 0!==f?f:1;f="rtl"===a.direction;f=c?a.ra(c.fc)*g*(f?1:-1):0;var h=c?-a.ua(c.rc)*g:0;d.current.style.transform=`translate(${f}px, ${h}px)`;e.current.style.width=`${a.width*g}px`;e.current.style.height=`${a.height*g}px`}}),[a,c,d,e,b])},OIb=function({onScroll:a}){const b=new MIb(a);return{SA:b,lda:G5(c=>C5(NIb,{sheet:c.sheet,SA:b,children:c.children}))}},SIb=function(a){const b=
a.rr,c=a.Ce,d=a.jMa,e=({children:k})=>k,{SA:f,lda:g}=OIb({onScroll:a.onScroll});class h extends PIb{get VI(){const k=this.props.Kb.aG;switch(k){case "screen":return g;case "print":return e;default:throw new D(k);}}componentDidMount(){d.$La(this.props.item,{$b:this.props.$b,Kb:this.props.Kb,Tg:this.props.Tg})}componentWillUnmount(){d.TVa(this.props.item,{$b:this.props.$b,Kb:this.props.Kb,Tg:this.props.Tg})}render(){d.$La(this.props.item,{$b:this.props.$b,Kb:this.props.Kb,Tg:this.props.Tg});return C5(QIb,
{...this.props,scaleFactor:this.scaleFactor,rr:b,VI:this.VI,Yh:this.Yh,jMa:d,SA:f})}constructor(...k){super(...k);this.scaleFactor=M5(()=>{const l=this.props.item;var m=this.props.Kb,n=m.aG;m=m.zoom;switch(n){case "screen":return 1;case "print":n=d.x1a(l);if(!n)return 1;({width:n}=new __c.cG(l,n.$b,{zoom:m}));return n/l.config.width;default:throw new D(n);}});this.Yh=G5(l=>C5("div",{className:"wKvivQ",children:C5(RIb,{...this.props,...l,Ce:c})}))}}return{FSa:h,SA:f}},TIb=function(a,b){if(null!=b&&
null!=b.fc&&null!=b.rc&&null!=b.Yc&&null!=b.rd){var c=a.ra(b.fc),d=a.ua(b.rc),e=a.ra(b.Yc)+b.Yc.width-c;a=a.ua(b.rd)+b.rd.height-d;return __c.St({top:d,left:c,width:e,height:a})}},VIb=function(a){const b=a.rr,c=()=>null;return d=>C5(UIb,{...d,rr:b,Yh:c})},ZIb=function(a,b,c,d,e,f){if(0===d.length||0===e.length)return[];const g=WIb(b,c,d,e);f=XIb(b,c,d,e,f);const h=YIb(a,b,c,d,e),k=a.t1a(b),l=a.T0a(b),m="rtl"===b.direction;a=g.map(n=>{var p,q,r=n.lcb,t=n.Aia,u=n.XKa;const w=n.color,x=n.weight;n=n.Zb;
const y=m?-1:1,z=null===(p=h.get(N5(r,u)))||void 0===p?void 0:p.Ka;p=null===(q=h.get(N5(t,u)))||void 0===q?void 0:q.ra;if(null!=z&&null!=p){q=C(k.get(u.va));var A=C(l.get(r.column));r=C(l.get(t.column));u="start"===u.boundary?q.start:q.end;q=A.start;t="start"===t.boundary?r.start:r.end;return{color:w,weight:x,Zb:n,p1:new __c.tt(q+z*y,u),p2:new __c.tt(t+p*y,u),...__c.gJ((t-q)*y,n*x,z)}}}).filter(__c.xb);return[...f.map(n=>{var p,q,r=n.hya,t=n.tcb,u=n.Dia;const w=n.color,x=n.weight;n=n.Zb;const y=null===
(p=h.get(N5(r,t)))||void 0===p?void 0:p.Ea;p=null===(q=h.get(N5(r,u)))||void 0===q?void 0:q.ua;if(null!=y&&null!=p){q=C(l.get(r.column));var z=C(k.get(t.va));t=C(k.get(u.va));r="start"===r.boundary?q.start:q.end;q=z.start;u="start"===u.boundary?t.start:t.end;return{color:w,weight:x,Zb:n,p1:new __c.tt(r,q+y),p2:new __c.tt(r,u+p),...__c.gJ(u-q,n*x,y)}}}).filter(__c.xb),...a]},$Ib=function(a){const b=[];a=a.filter(c=>0!==c.weight&&null!=c.color);a=__c.td(a,c=>c.weight);a=Array.from(a.entries()).sort(([c],
[d])=>c-d);for(const [c,d]of a){a=__c.td(d,e=>`${e.fj}_${e.gj}`);for(const [,e]of a){const {gj:f,fj:g}=e[0];a=__c.td(e,h=>h.color);for(const [h,k]of a)b.push({weight:c,color:h,lines:k,fj:g,gj:f})}}return b},bJb=function(a,b,c,d){var e=aJb;const f=b.get().flatMap(k=>a.layout.rows.last()===k?[{va:k,boundary:"start"},{va:k,boundary:"end"}]:[{va:k,boundary:"start"}]),g=c.get().flatMap(k=>a.layout.cols.last()===k?[{column:k,boundary:"start"},{column:k,boundary:"end"}]:[{column:k,boundary:"start"}]),h=
new Map;for(const k of b.get())for(const l of c.get())b=l&&k?e.iMa.sab(a,l,k):void 0,b&&h.set(`${l.id}:${k.id}`,b);c=ZIb(e,a,h,f,g,d);return $Ib(c)},WIb=function(a,b,c,d){const e=[];for(const k of c)for(const l of d){c=k.va;var f=l.column,g=a.layout.cells.get(c,f);if(!g||("start"===k.boundary?g.span.rc===c:g.span.rd===c))if(c=b.get(`${f.id}:${c.id}`),c="start"===k.boundary?null===c||void 0===c?void 0:c.ua:null===c||void 0===c?void 0:c.Ea){g=e[e.length-1];f=(f=a.layout.cols.next(f))?{column:f,boundary:"start"}:
{column:C(a.layout.cols.last()),boundary:"end"};var h;if(h=g)h=g.Aia,h=h.column===l.column&&h.boundary===l.boundary;h&&(h=g.XKa,h=h.va===k.va&&h.boundary===k.boundary);h&&g.color===c.color&&g.weight===c.weight&&g.Zb===c.Zb&&0===g.Zb?g.Aia=f:e.push({XKa:k,lcb:l,Aia:f,color:c.color,weight:c.weight,Zb:c.Zb})}}return e},XIb=function(a,b,c,d,e){const f=[];for(const l of d)for(const m of c){var g=m.va,h=l.column;d=a.layout.cells.get(g,h);if(!d||("start"===l.boundary?d.span.fc===h:d.span.Yc===h))if(d=b.get(`${h.id}:${g.id}`),
(d="start"===l.boundary?null===d||void 0===d?void 0:d.ra:null===d||void 0===d?void 0:d.Ka)&&("start"!==l.boundary||1!==e(g,h))){h=f[f.length-1];g=(g=a.layout.rows.next(g))?{va:g,boundary:"start"}:{va:C(a.layout.rows.last()),boundary:"end"};var k;if(k=h)k=h.hya,k=k.column===l.column&&k.boundary===l.boundary;k&&(k=h.Dia,k=k.va===m.va&&k.boundary===m.boundary);k&&h.color===d.color&&h.weight===d.weight&&h.Zb===d.Zb&&0===h.Zb?h.Dia=g:f.push({hya:l,tcb:m,Dia:g,color:d.color,weight:d.weight,Zb:d.Zb})}}return f},
YIb=function(a,b,c,d,e){const f=a.iMa.WWa(c,b.layout.rows.last(),b.layout.cols.last());a=(q,r)=>{const t=f.get(q)||0,u=f.get(r)||0;return t<=u?q:r};const g=new Map;if(0===d.length||0===e.length)return g;var h=[],k=b.layout.cols.vc(e[0].column);k&&h.push({column:k,boundary:"start"});h.push(...e);(e=b.layout.cols.next(e[e.length-1].column))&&h.push({column:e,boundary:"start"});e=[];(k=b.layout.rows.vc(d[0].va))&&e.push({va:k,boundary:"start"});e.push(...d);(d=b.layout.rows.next(d[d.length-1].va))&&
e.push({va:d,boundary:"start"});for(const q of h){h=(d="start"===q.boundary?q.column:void 0)?b.layout.cols.vc(d):b.layout.cols.last();for(const r of e){var l="start"===r.boundary?r.va:void 0;k=l?b.layout.rows.vc(l):b.layout.rows.last();var m=d&&l&&c.get(`${d.id}:${l.id}`),n=d&&k&&c.get(`${d.id}:${k.id}`);l=h&&l&&c.get(`${h.id}:${l.id}`);var p=h&&k&&c.get(`${h.id}:${k.id}`);k="end"===q.boundary?null===l||void 0===l?void 0:l.Ka:null===m||void 0===m?void 0:m.ra;m="end"===r.boundary?null===n||void 0===
n?void 0:n.Ea:null===m||void 0===m?void 0:m.ua;n="end"===q.boundary?null===p||void 0===p?void 0:p.Ka:null===n||void 0===n?void 0:n.ra;l="end"===r.boundary?null===p||void 0===p?void 0:p.Ea:null===l||void 0===l?void 0:l.ua;p=__c.YCa({ua:n,Ea:k,ra:l,Ka:m},a);let t;switch(p){case "blockStart":t=n;break;case "blockEnd":t=k;break;case "inlineStart":t=l;break;case "inlineEnd":t=m;break;default:t=void 0}const {height:u,width:w}=1===(null===t||void 0===t?void 0:t.Zb)?{height:t.weight,width:t.weight}:{height:Math.max((null===
l||void 0===l?void 0:l.weight)||0,(null===m||void 0===m?void 0:m.weight)||0),width:Math.max((null===n||void 0===n?void 0:n.weight)||0,(null===k||void 0===k?void 0:k.weight)||0)};g.set(N5(q,r),__c.bJ(p,u/2,w/2))}}return g},O5=function(a,b,c,d,e){if(a&&b){var f=b.ls?a.ls?void 0:a:b;return __c.dJ(b.borderStyle,a.borderStyle,d,c,e,null===f||void 0===f?void 0:f.borderStyle)}return null!==(f=null===a||void 0===a?void 0:a.borderStyle)&&void 0!==f?f:null===b||void 0===b?void 0:b.borderStyle},cJb=function(a,
b,c){var d=b&&c&&a.layout.cells.get(c,b),e,f,g=b&&c?a.layout.attrs.get(bh({P2:void 0,X2:void 0,T2:void 0}),null!==(e=null===d||void 0===d?void 0:d.span.rc)&&void 0!==e?e:c,null!==(f=null===d||void 0===d?void 0:d.span.fc)&&void 0!==f?f:b)||{}:void 0;if(b&&c){b={color:a.Di.color,weight:a.Di.weight,Zb:eJ(a.Di.Ed)};if(!g)return a.Al?void 0:{borderStyle:b,ls:!0};c=P5(g.P2);d=Q5(g.X2);g=R5(g.T2);return null==c&&null==d&&null==g?a.Al?void 0:{borderStyle:b,ls:!0}:{borderStyle:{color:null!==c&&void 0!==c?
c:b.color,weight:null!==d&&void 0!==d?d:b.weight,Zb:g?eJ(g):b.Zb},ls:!1}}},dJb=function(a,b,c){var d=b&&c&&a.layout.cells.get(c,b),e,f,g=b&&c?a.layout.attrs.get(bh({O2:void 0,W2:void 0,S2:void 0}),null!==(e=null===d||void 0===d?void 0:d.span.rc)&&void 0!==e?e:c,null!==(f=null===d||void 0===d?void 0:d.span.fc)&&void 0!==f?f:b)||{}:void 0;if(b&&c){b={color:a.Di.color,weight:a.Di.weight,Zb:eJ(a.Di.Ed)};if(!g)return a.Al?void 0:{borderStyle:b,ls:!0};c=P5(g.O2);d=Q5(g.W2);g=R5(g.S2);return null==c&&null==
d&&null==g?a.Al?void 0:{borderStyle:b,ls:!0}:{borderStyle:{color:null!==c&&void 0!==c?c:b.color,weight:null!==d&&void 0!==d?d:b.weight,Zb:g?eJ(g):b.Zb},ls:!1}}},eJb=function(a,b,c){var d=b&&c&&a.layout.cells.get(c,b),e,f,g=b&&c?a.layout.attrs.get(bh({R2:void 0,Z2:void 0,V2:void 0}),null!==(e=null===d||void 0===d?void 0:d.span.rc)&&void 0!==e?e:c,null!==(f=null===d||void 0===d?void 0:d.span.fc)&&void 0!==f?f:b)||{}:void 0;if(b&&c){b={color:a.Di.color,weight:a.Di.weight,Zb:eJ(a.Di.Ed)};if(!g)return a.Al?
void 0:{borderStyle:b,ls:!0};c=P5(g.R2);d=Q5(g.Z2);g=R5(g.V2);return null==c&&null==d&&null==g?a.Al?void 0:{borderStyle:b,ls:!0}:{borderStyle:{color:null!==c&&void 0!==c?c:b.color,weight:null!==d&&void 0!==d?d:b.weight,Zb:g?eJ(g):b.Zb},ls:!1}}},fJb=function(a,b,c){var d=b&&c&&a.layout.cells.get(c,b),e,f,g=b&&c?a.layout.attrs.get(bh({Q2:void 0,Y2:void 0,U2:void 0}),null!==(e=null===d||void 0===d?void 0:d.span.rc)&&void 0!==e?e:c,null!==(f=null===d||void 0===d?void 0:d.span.fc)&&void 0!==f?f:b)||{}:
void 0;if(b&&c){b={color:a.Di.color,weight:a.Di.weight,Zb:eJ(a.Di.Ed)};if(!g)return a.Al?void 0:{borderStyle:b,ls:!0};c=P5(g.Q2);d=Q5(g.Y2);g=R5(g.U2);return null==c&&null==d&&null==g?a.Al?void 0:{borderStyle:b,ls:!0}:{borderStyle:{color:null!==c&&void 0!==c?c:b.color,weight:null!==d&&void 0!==d?d:b.weight,Zb:g?eJ(g):b.Zb},ls:!1}}},P5=function(a){return null==a||"inherit"===a?void 0:a},Q5=function(a){return null==a||"inherit"===a?void 0:Number(a.split("px")[0])},R5=function(a){return null==a||"inherit"===
a?void 0:a.split(" ").map(b=>{b=Number(b);return 0<b?b:void 0}).filter(__c.xb)},S5=function(a,b,c){let d=0;for(;null!=a&&a!==b;)(a=c.next(a))&&d++;return d},gJb=function(a,b){return(null===a||void 0===a?void 0:a.Ea)===(null===b||void 0===b?void 0:b.Ea)&&(null===a||void 0===a?void 0:a.ua)===(null===b||void 0===b?void 0:b.ua)&&(null===a||void 0===a?void 0:a.Ka)===(null===b||void 0===b?void 0:b.Ka)&&(null===a||void 0===a?void 0:a.ra)===(null===b||void 0===b?void 0:b.ra)},iJb=function(a){const b={transform:"translate(-1000px, -1000px) scale(0)"},
c={Hxa:b,EF:b,Ha:{},$y:{}},d=T5(()=>a.Zaa.style||c,g=>{var h;Object.assign(a.Wfa.style,g.Hxa);Object.assign(a.sO.style,g.EF);Object.assign(a.FF.style,g.Ha);Object.assign(a.gC.style,g.$y);g=null===g||void 0===g?void 0:null===(h=g.Ha)||void 0===h?void 0:h.textDecoration;a.FF.classList.toggle("OQx3PQ","underline"===g);a.FF.classList.toggle("_99ezUA","line-through"===g);a.FF.classList.toggle("kppAqQ","underline line-through"===g)},{fireImmediately:!0,equals:U5.structural}),e=T5(()=>a.FX,g=>{a.FF.classList.toggle("_84KvRA",
!g)},{fireImmediately:!0}),f=T5(()=>a.renderer,g=>{a.i4&&"react"!==(null===g||void 0===g?void 0:g.type)?(a.i4=void 0,a.uZ.remove()):a.gC.innerHTML="";switch(null===g||void 0===g?void 0:g.type){case "react":a.i4=hJb(g.node,a.uZ);a.gC.appendChild(a.uZ);break;case "dom":g.render(a.gC);break;case void 0:break;default:throw new D(g);}a.ona()},{fireImmediately:!0});return()=>{d();e();f()}},kJb=function(a){const b=a.ey,c=a.wB,d=new jJb(a.o_);return e=>C5(V5,{...e,wB:c,ey:b,Zka:d})},AIb=({Pe:a,zN:b})=>c=>
(0,__c.N)(__c.zfb,{...c,Pe:a,zN:b}),W5=__webpack_require__(443763),X5=W5.Fragment,C5=W5.jsx,Y5=W5.jsxs;var G5=__webpack_require__(225881).Pi;var Z5=__webpack_require__(875604),$5=Z5.Component,PIb=Z5.PureComponent,H5=Z5.useCallback,KIb=Z5.useEffect,lJb=Z5.useLayoutEffect,F5=Z5.useMemo,mJb=Z5.useState;var a6=__webpack_require__(42782),b6=a6.aD,L5=a6.EH,U5=a6.p6,M5=a6.Fl,nJb=a6.cp,c6=a6.LO,T5=a6.U5,oJb=a6.rg;var d6=__webpack_require__(240236).gn;var pJb=__webpack_require__,qJb=pJb(993864),E5=pJb.n_x(qJb)();var rJb=__webpack_require__(358579).Z;var e6=__webpack_require__(649799),f6=e6.Om,g6=e6.kq,h6=e6.YN;var hJb=__webpack_require__(204358).createPortal;var sJb=G5(a=>{var b,c,d="rtl"===a.sheet.direction;d={H2wykw:!d,UweldA:d};const [e]=mJb(()=>Py()),f={get:H5(()=>{var g;const h=null===e||void 0===e?void 0:null===(g=e.current)||void 0===g?void 0:g.getBoundingClientRect();var k,l;g={top:0,left:0,width:null!==(k=null===h||void 0===h?void 0:h.width)&&void 0!==k?k:0,height:null!==(l=null===h||void 0===h?void 0:h.height)&&void 0!==l?l:0};return __c.St(g)},[e])};return Y5("div",{className:E5("nMvVqA",d),children:[Y5("div",{ref:rJb(a.xd,e),className:"_0YOFPg",
children:[C5(a.rr,{...a,viewport:f}),C5("div",{className:E5("Gdl7fQ",d),children:null===(c=a.Qua)||void 0===c?void 0:null===(b=c.get())||void 0===b?void 0:b.map((g,h)=>C5(g,{},h))})]}),"visible"===a.Kob&&Y5(X5,{children:[C5("div",{className:E5("_32sKQw",d),children:C5(a.CSa,{...a})}),C5("div",{className:E5("xdIsTQ",d),children:C5(a.GSa,{...a})}),C5("div",{className:E5("rsTRSA",d),children:C5(a.ESa,{...a})})]})]})}),tJb=G5(a=>{a=a.content;__c.v("text2"===a.type||"text3"===a.type);switch(a.type){case "text2":return a.value.Y;
case "text3":return __c.xq.oa(a.value).cells.Y();default:throw new D(a);}});var zIb=wIb((a,b)=>{const c=a.value;({Ci:a}=qg(__c.ah,a.context.attrs));const d=document.createElement("div");"wrap"===a&&(d.className="dt4Dlg",d.style.overflowWrap="break-word");d.innerText=c;b.appendChild(d)});var BIb=a=>wIb((b,c)=>{const d=b.content;b=b.context;if(d.value.isEmpty)for(;c.lastChild;)c.lastChild.remove();else({Ci:b}=qg(__c.ah,b.attrs)),"wrap"===b&&(c=c.appendChild(document.createElement("div")),c.className="dt4Dlg"),a.render({container:c,text:d.value,Ga:void 0,writingMode:1,pd:"start",Rf:uJb(d,b)})}),uJb=f6((a,b)=>{if("wrap"===b)return[];a=a.value.Y.split("\n").map(c=>c.length+1);a.pop();return a},{equals:U5.structural});var D5=class a extends $5{static j(b){P(b,{Ci:M5})}get Ci(){return qg(__c.ah,this.props.context.attrs).Ci}render(){var b=this.props.content;const c=this.props.context;if(b.value.isEmpty)return null;b=C5(this.props.Yh,{content:b,va:c.va,col:c.col,Ci:this.Ci},this.key++);return"wrap"===this.Ci?C5("div",{className:"dt4Dlg",children:b}):C5(X5,{children:b})}constructor(...b){super(...b);a.j(this);this.key=0}};D5=d6([Lc],D5);var vJb=5*__c.eA,wJb=3*__c.eA;var HIb=class{Sn(a,b){return"large"===b?vJb*a:wJb*a}constructor(){this.f4a=f6((a,b)=>{var c,d;b=b.get();return null!=b&&a.layout.rows.count()===((null===(c=b.rows)||void 0===c?void 0:c.size)||0)&&a.layout.cols.count()===((null===(d=b.columns)||void 0===d?void 0:d.size)||0)});this.yLa=g6(a=>{var b;return new Set((null===(b=a.get())||void 0===b?void 0:b.columns)||[])},{equals:__c.gs});this.ALa=g6(a=>{var b;return new Set((null===(b=a.get())||void 0===b?void 0:b.rows)||[])},{equals:__c.gs});this.g2a=
f6((a,b)=>{var {cells:c}=b.get()||{};if(!c||0===c.size)return new Set;b=this.yLa(b);const d=new Set;for(const e of c){c=a.layout.cells.get(e.va,e.column);for(const f of DIb(c?c.span.fc:e.column,c?c.span.Yc:e.column,a.layout.cols))(0===b.size||b.has(f))&&d.add(f)}return d},{equals:__c.gs});this.h2a=f6((a,b)=>{var {cells:c}=b.get()||{};if(!c||0===c.size)return new Set;b=this.ALa(b);const d=new Set;for(const e of c){c=a.layout.cells.get(e.va,e.column);for(const f of DIb(c?c.span.rc:e.va,c?c.span.rd:
e.va,a.layout.rows))(0===b.size||b.has(f))&&d.add(f)}return d},{equals:__c.gs})}};var I5=class a extends $5{static j(b){P(b,{ud:M5,pp:M5,Kra:M5})}get ud(){return"rtl"===this.props.sheet.direction}get pp(){var b;const c=null===(b=this.props.ds)||void 0===b?void 0:b.get();if(null!=c&&0!==c.length)return new __c.QF(c)}get Kra(){var b,c,d;return null===(c=(d=this.props).d1a)||void 0===c?void 0:null===(b=c.call(d))||void 0===b?void 0:b.get()}render(){return C5(__c.qA,{Zo:"light",light:"light",Er:"light",dark:"light",children:this.jWa})}constructor(...b){super(...b);a.j(this);this.onMouseMove=
b6(c=>{const {onMouseMove:d,sheet:e,scale:f=1}=this.props;null===d||void 0===d?void 0:d(c,e,"column",f)});this.onMouseLeave=b6(c=>{var d,e;null===(d=(e=this.props).onMouseLeave)||void 0===d?void 0:d.call(e,c)});this.U$a=()=>{const {sheet:c,sMa:d,hEa:e,Sn:f,scale:g=1}=this.props;let h=-1;return Y5("div",{style:void 0,className:E5("Vt2_4w",{jNbTIg:!this.ud,gtA7Dw:this.ud},{Tn3nUw:void 0}),onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,children:[c.cols.map(k=>{h++;return C5(xJb,{col:k,label:__c.KD(h),
lra:d,Fk:e,Sn:f,scale:g},k.id)}),void 0]})};this.jWa=c=>{var d;const e={jNbTIg:!this.ud,gtA7Dw:this.ud};return Y5("div",{ref:null===(d=this.pp)||void 0===d?void 0:d.Qk,className:E5("xhBZaw",e,c.className),children:[void 0,this.U$a()]})}}};I5=d6([Lc],I5);
var J5=class a extends $5{static j(b){P(b,{ud:M5,pp:M5,Kra:M5})}get ud(){return"rtl"===this.props.sheet.direction}get pp(){var b;const c=null===(b=this.props.ds)||void 0===b?void 0:b.get();if(null!=c&&0!==c.length)return new __c.QF(c)}get Kra(){var b,c,d;return null===(c=(d=this.props).d1a)||void 0===c?void 0:null===(b=c.call(d))||void 0===b?void 0:b.get()}render(){return C5(__c.qA,{Zo:"light",light:"light",Er:"light",dark:"light",children:this.Gab})}constructor(...b){super(...b);a.j(this);this.onMouseMove=
b6(c=>{const {onMouseMove:d,sheet:e,scale:f=1}=this.props;null===d||void 0===d?void 0:d(c,e,"row",f)});this.onMouseLeave=b6(c=>{var d,e;null===(d=(e=this.props).onMouseLeave)||void 0===d?void 0:d.call(e,c)});this.cab=()=>{const {sheet:c,tMa:d,DEa:e,Sn:f,scale:g=1}=this.props;let h=-1;return Y5("div",{style:void 0,className:E5("_93roJg",{jNbTIg:!this.ud,gtA7Dw:this.ud},{Tn3nUw:void 0}),onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,children:[c.rows.map(k=>{h++;return C5(yJb,{va:k,label:`${h+
1}`,lra:d,Fk:e,Sn:f,scale:g},k.id)}),void 0]})};this.Gab=c=>{var d;const e={jNbTIg:!this.ud,gtA7Dw:this.ud};return Y5("div",{ref:null===(d=this.pp)||void 0===d?void 0:d.Qk,className:E5("An9VeA",e,c.className),children:[void 0,this.cab()]})}}};J5=d6([Lc],J5);
var xJb=G5(a=>{const {label:b,col:c,lra:d,Fk:e,Sn:f,scale:g=1}=a;a=f(g);const h=h6(()=>d(c)),k=h6(()=>e(c));return C5("div",{className:E5("_83Rssw","d2uLIA",{YbLr8g:h,sTqdww:k}),style:{width:c.width*g,height:a},children:C5(EIb,{label:b,width:c.width,height:f(1),scale:g,highlight:h,selected:k})})}),yJb=G5(a=>{const {label:b,va:c,lra:d,Fk:e,Sn:f,scale:g=1}=a;a=f(g);const h=h6(()=>d(c)),k=h6(()=>e(c));return C5("div",{className:E5("_83Rssw","JhBzyw",{YbLr8g:h,sTqdww:k}),style:{width:a,height:c.height*
g},children:C5(EIb,{label:b,width:f(1),height:c.height,scale:g,highlight:h,selected:k})})});var zJb='<svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><circle stroke="currentColor" cx="6" cy="6" r="5.5"/></svg>';var AJb='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle stroke="currentColor" cx="12" cy="12" r="9.25" stroke-width="1.5"/></svg>';var FIb=__c.dS({Wl:zJb,medium:AJb});var K5=class a extends $5{static j(b){P(b,{Jd:M5.struct})}constructor(...b){super(...b);a.j(this)}render(){return C5(this.props.rr,{sheet:this.props.element.config,ds:this.props.ds,Mz:this.props.Mz,Qz:this.props.Qz,scaleFactor:this.props.scaleFactor,Jd:this.Jd,Yh:this.props.Yh,XT:void 0})}get Jd(){const b=this.props.Td,c=this.props.element.altText;return c?c.Wd&&!b?{"aria-hidden":!0}:{"aria-label":c.text}:{}}};K5=d6([Lc],K5);var BJb=class{constructor(){this.paa=new WeakMap;this.x1a=a=>this.paa.get(a);this.$La=(a,b)=>{this.paa.set(a,b)};this.TVa=(a,b)=>{const c=this.paa.get(a);c&&c.Kb===b.Kb&&c.$b===b.$b&&c.Tg===b.Tg&&this.paa.delete(a)}}};var RIb=G5(a=>{const b=a.Kb,c=a.item,d=a.Tg,e=a.$b,f=a.Ce,g=a.col,h=a.va,k=a.content,l=a.Ci;a=a.Lu;__c.v("text3"===k.type);__c.$F(a,__c.xq.oa(k.value),(p,q)=>__c.xq.domain.Pb(p,q));[a]=mJb(()=>new CJb(c,e,M5(()=>b.zoom)));const m=F5(()=>new __c.Z1a(d,c),[d,c]),n=F5(()=>{var p=new __c.$1a(m,g,h);return new __c.a2a(p,k.value)},[m,g,h,k.value]);return C5(f,{Kb:b,Gg:n,text:k.value,$b:a,Rf:"wrap"===l?"pre-wrap":"nowrap"})}),CJb=class extends __c.BS{static j(a){P(a,{width:c6.ref,T0:M5})}get YB(){return this.oaa.YB}get T0(){const a=
(this.Ela.width-this.oaa.width)/2;return{left:-a,right:this.oaa.width+a}}constructor(a,b,c){super();CJb.j(this);this.sheet=a;this.oaa=b;this.zoom=c;this.width=0;this.marginWidth=void 0;this.Ela=new __c.cG(this.sheet,this.oaa,{zoom:this.zoom.get()})}};var i6=parseInt("4px",10)||4,DJb=G5(({sheet:a,scaleFactor:b,range:c,$t:d,au:e})=>{if(null!=c&&(d||e)){var f;b=null!==(f=null===b||void 0===b?void 0:b.get())&&void 0!==f?f:1;if(d&&e)return d=a.ua(c.rd)+c.rd.height,a=a.ra(c.Yc)+c.Yc.width,C5("div",{style:{top:d*b,width:a*b,height:i6*b},className:E5("aX8dhQ","VGcLng")});if(d)return c=a.ra(c.Yc)+c.Yc.width,C5("div",{style:{left:c*b,width:i6*b,height:a.height*b},className:E5("aX8dhQ","gl1RPg")});if(e)return c=a.ua(c.rd)+c.rd.height,C5("div",{style:{top:c*
b,width:a.width*b,height:i6*b},className:E5("aX8dhQ","VGcLng")})}});var j6=({sheet:a,range:b,scaleFactor:c,children:d})=>{const e=B5();LIb({sheet:a,scaleFactor:c,range:b,xd:e,UDa:e});return C5("div",{ref:e,className:E5("nstn2A","rtl"===a.direction?"NgnL2Q":"f8jAGQ"),children:d})},EJb=({sheet:a,range:b,scaleFactor:c,children:d})=>{const e=B5(),f=B5();LIb({sheet:a,scaleFactor:c,range:b,xd:e,UDa:f});a="rtl"===a.direction?"NgnL2Q":"f8jAGQ";return C5("div",{ref:e,className:E5("nstn2A",a,"_9sodyg"),children:C5("div",{ref:f,className:E5("nstn2A",a),children:d})})};var NIb=G5(({sheet:a,children:b,SA:c})=>{const d=H5(f=>{c.Xqa(a,f)},[c,a]),e=H5(f=>{null!=f?c.TH.set(a,f):c.TH.delete(a)},[c,a]);return C5(__c.zhb,{direction:"rtl"===a.config.direction?"rtl":"ltr",onScroll:d,bv:e,children:b})}),MIb=class{Xqa(a,b){this.onScroll&&this.onScroll(a);this.YZ.set(a,b)}constructor(a){this.onScroll=a;this.TH=new WeakMap;this.YZ=c6.map(new Map,{deep:!1});this.scrollTo=b6((b,c)=>{b=this.TH.get(b);null===b||void 0===b?void 0:b.scrollTo({left:Math.floor(c)})})}};var QIb=G5(a=>{const b=a.item,c=a.ds,d=a.measureRef,e=a.scaleFactor,f=a.X2a,g=a.$b,h=a.Mz,k=a.Qz,l=a.rr,m=a.VI,n=a.Yh,p=a.Td;a=a.SA;const q=F5(()=>{const t=b.altText;return t?t.Wd&&!p?{"aria-hidden":!0}:{"aria-label":t.text}:{}},[b,p]),r=F5(()=>G5(({sheet:t,range:u,$t:w,au:x})=>C5(j6,{sheet:t,range:u,scaleFactor:e,children:C5(DJb,{sheet:t,scaleFactor:e,range:u,$t:w,au:x})})),[e]);KIb(()=>L5(()=>{}),[b,g.width,a]);return C5("div",{ref:d,className:"E8r86A",style:{width:Math.min(g.width,b.F)},children:C5(m,
{sheet:b,children:C5("div",{ref:f,className:"cXTiJA",style:{width:b.F,height:b.P},children:C5(l,{sheet:b.config,ds:c,scaleFactor:e,Mz:h,Qz:k,Jd:q,Yh:n,XT:r})})})})});var FJb=G5(({page:a,range:b,NA:c})=>{const d=TIb(a.sheet,b);return C5("div",{className:"Gi9pfA",children:a.elements.map((e,f)=>null==d?c(e,f):__c.Qt(__c.St(e)).Dp(d)&&c(e,f))})});var GJb=new __c.$T,k6=a=>vJb*a,l6=()=>!1,UIb=G5(({page:a,ds:b,Mz:c,Qz:d,n6:e,scaleFactor:f,viewport:g,Xbb:h,rr:k,Yh:l,NA:m,D$:n,thb:p,sgb:q,qgb:r})=>{var t="rtl"===a.sheet.direction,u;const w=null!==(u=null===f||void 0===f?void 0:f.get())&&void 0!==u?u:1;u=F5(()=>G5(({sheet:x,range:y,$t:z,au:A})=>Y5(X5,{children:[C5(j6,{sheet:a.sheet,range:y,scaleFactor:f,children:C5(DJb,{sheet:x,scaleFactor:f,range:y,$t:z,au:A})}),Y5(EJb,{sheet:a.sheet,range:y,scaleFactor:f,children:[p&&C5(p,{}),m&&C5(FJb,{page:a,
NA:m,range:y}),r&&C5(r,{}),n&&n()]}),q&&y&&C5(j6,{sheet:a.sheet,range:y,scaleFactor:f,children:C5(q,{range:y})})]})),[a,f,p,m,r,n,q]);b=C5(k,{sheet:a.sheet,ds:b,Mz:c,Qz:d,n6:e,scaleFactor:f,viewport:g,Yh:l,XT:u});t=Y5("div",{className:"OsKKIQ",children:[C5("div",{className:"VDFv_A",children:b}),C5("div",{className:"_688KWg",children:C5(GIb,{ud:t,highlight:!1,Sn:k6,scale:w})}),C5("div",{className:"m0cT1w",children:C5(I5,{sheet:a.sheet,scale:w,Sn:k6,hEa:l6,sMa:l6,GD:GJb})}),C5("div",{className:"zm537g",
children:C5(J5,{sheet:a.sheet,scale:w,Sn:k6,DEa:l6,tMa:l6,GD:GJb})})]});return h?t:b});var N5=(a,b)=>`${a.column.id}-${a.boundary}:${b.va.id}-${b.boundary}`,IJb=class{constructor(){this.iMa=HJb;this.t1a=g6(a=>{const b=new Map;let c=0;a.layout.rows.forEach(d=>{const e=c,f=e+d.height;b.set(d,{start:e,end:f});c=f});return b});this.T0a=g6(a=>{const b=new Map;var c="rtl"===a.direction;const d=c?-1:1;let e=0;c&&(c=a.layout.cols.last(),e=null!=c?a.ra(c)+c.width:0);a.layout.cols.forEach(f=>{const g=e,h=g+f.width*d;b.set(f,{start:g,end:h});e=h});return b})}},JJb=class{constructor(){this.sab=
f6((a,b,c)=>{const d=a.layout.cells.get(c,b);var e,f,g=S5(null!==(e=null===d||void 0===d?void 0:d.span.fc)&&void 0!==e?e:b,null!==(f=null===d||void 0===d?void 0:d.span.Yc)&&void 0!==f?f:b,a.layout.cols),h,k;e=S5(null!==(h=null===d||void 0===d?void 0:d.span.rc)&&void 0!==h?h:c,null!==(k=null===d||void 0===d?void 0:d.span.rd)&&void 0!==k?k:c,a.layout.rows);var l=d?c===d.span.rc:!0;const m=d?c===d.span.rd:!0,n=d?b===d.span.fc:!0;f=d?b===d.span.Yc:!0;if(n||f||l||m){h={};var p=a.layout.rows.vc(c),q=a.layout.rows.next(c),
r=a.layout.cols.vc(b);k=a.layout.cols.next(b);if(l){l=cJb(a,b,c);const aa=b&&p&&a.layout.cells.get(p,b);p=b&&p&&dJb(a,b,p);var t,u;const la=S5(null!==(t=null===aa||void 0===aa?void 0:aa.span.fc)&&void 0!==t?t:b,null!==(u=null===aa||void 0===aa?void 0:aa.span.Yc)&&void 0!==u?u:b,a.layout.cols);var w,x;t=a.layout.cols.hg(null!==(w=null===d||void 0===d?void 0:d.span.fc)&&void 0!==w?w:b,null!==(x=null===aa||void 0===aa?void 0:aa.span.fc)&&void 0!==x?x:b);h.ua=O5(l,p,g,la,t)}if(m){w=dJb(a,b,c);x=b&&q&&
a.layout.cells.get(q,b);t=b&&q&&cJb(a,b,q);var y,z;u=S5(null!==(y=null===x||void 0===x?void 0:x.span.fc)&&void 0!==y?y:b,null!==(z=null===x||void 0===x?void 0:x.span.Yc)&&void 0!==z?z:b,a.layout.cols);var A,G;y=a.layout.cols.hg(null!==(A=null===d||void 0===d?void 0:d.span.fc)&&void 0!==A?A:b,null!==(G=null===x||void 0===x?void 0:x.span.fc)&&void 0!==G?G:b);h.Ea=O5(w,t,g,u,y)}if(n){g=eJb(a,b,c);A=r&&c&&a.layout.cells.get(c,r);G=r&&c&&fJb(a,r,c);var F,H;y=S5(null!==(F=null===A||void 0===A?void 0:A.span.rc)&&
void 0!==F?F:c,null!==(H=null===A||void 0===A?void 0:A.span.rd)&&void 0!==H?H:c,a.layout.rows);var J,K;F=a.layout.rows.hg(null!==(J=null===d||void 0===d?void 0:d.span.rc)&&void 0!==J?J:c,null!==(K=null===A||void 0===A?void 0:A.span.rc)&&void 0!==K?K:c);h.ra=O5(g,G,e,y,F)}if(f){b=fJb(a,b,c);J=k&&c&&a.layout.cells.get(c,k);K=k&&c&&eJb(a,k,c);var L,R;F=S5(null!==(L=null===J||void 0===J?void 0:J.span.rc)&&void 0!==L?L:c,null!==(R=null===J||void 0===J?void 0:J.span.rd)&&void 0!==R?R:c,a.layout.rows);var S,
X;a=a.layout.rows.hg(null!==(S=null===d||void 0===d?void 0:d.span.rc)&&void 0!==S?S:c,null!==(X=null===J||void 0===J?void 0:J.span.rc)&&void 0!==X?X:c);h.Ka=O5(b,K,e,F,a)}return h}},{equals:gJb});this.WWa=(a,b,c)=>{const d=new Map;a.forEach(({ra:e,ua:f,Ka:g,Ea:h},k)=>{e&&d.set(e.color,(d.get(e.color)||0)+1);f&&d.set(f.color,(d.get(f.color)||0)+1);g&&c&&k.includes(c.id)&&d.set(g.color,(d.get(g.color)||0)+1);h&&b&&k.includes(b.id)&&d.set(h.color,(d.get(h.color)||0)+1)});return d}}},HJb=new JJb,aJb=
new IJb;var jJb=class{constructor(a){this.o_=a;this.HVa=__c.tU;this.f1a=f6((b,c,d,e)=>{d=d.get();const f=new WeakMap;for(let p=0;p<d.length;p++){var g=d[p],h=this.a1a(b,c,g);if(h){switch(h){case "start":case "justify":var k=d[p+1];if(null==k||!aJ(b,c,k))continue;break;case "center":k=d[p+1];if(null==k||!aJ(b,c,k))continue;k=d[p-1];if(null==k||!aJ(b,c,k))continue;break;case "end":k=d[p-1];if(null==k||!aJ(b,c,k))continue;break;default:throw new D(h);}if(k=e(c,g)){var l=k.width+("center"===h?0:this.HVa);if(!(g.width>
l)){switch(h){case "start":case "justify":h=b.ra(g);k=h+l;break;case "center":k=b.ra(g)+g.width/2;h=k-l/2;k+=l/2;break;case "end":k=b.ra(g)+g.width;h=k-l;break;default:throw new D(h);}for(l=d.indexOf(g);0<=l;l--){var m=d[l];const q=0>l-1||aJ(b,c,d[l-1]);var n;if(n=m===g||aJ(b,c,m))n=b.ra(m),n=h<n&&n<k;if(n&&q)f.set(m,1);else break}for(g=d.indexOf(g)+1;g<d.length;g++){l=d[g];if(m=aJ(b,c,l))m=b.ra(l),m=h<m&&m<k;if(m)f.set(l,1);else break}}}}}return f});this.a1a=(b,c,d)=>{var e,f;const g=b.layout.cells.get(c,
d);if(g&&(g.ref.content.ref||g.ref.Fa.ref)&&g.span.rc===g.span.rd&&g.span.fc===g.span.Yc){var {Ci:h,textAlign:k}=qg(__c.ah,b.layout.attrs.get(bh({Ci:void 0,textAlign:void 0}),c,d)||{});if("overflow"===h){var l=this.o_.QC(b,c,d);return __c.$I(k,null===(e=g.ref.content.ref)||void 0===e?void 0:e.type,null===(f=g.ref.Fa.ref)||void 0===f?void 0:f.type,l?()=>l.Zt.type:void 0)}}}}};var KJb=G5(function(a){const b=a.sheet;var c=a.lB;const d=a.bfb,e=a.scaleFactor,f=a.Zka,g=a.R0a,h=B5();lJb(()=>L5(()=>{const p=C(h.current);var q;const r=null!==(q=null===e||void 0===e?void 0:e.get())&&void 0!==q?q:1;q=b.height;p.style.width=`${b.width*r}px`;p.style.height=`${q*r}px`}),[h,e,b]);const k=H5(p=>f.f1a(b,p,d,g),[f,b,d,g]);var l;a=H5((p,q)=>{var r;return null!==(l=null===(r=k(p))||void 0===r?void 0:r.get(q))&&void 0!==l?l:0},[k]);c=bJb(b,c,d,a);a=b.width;const m=b.height,n="rtl"===b.direction;
return C5("svg",{ref:h,role:"presentation",className:E5("c6a1eQ",{H_CtIQ:!n,_8_56PQ:n}),viewBox:`0 0 ${a} ${m}`,strokeLinecap:"butt",strokeLinejoin:"miter",children:c.map(({lines:p,color:q,weight:r,fj:t,gj:u})=>C5("path",{stroke:q,strokeDasharray:t,strokeDashoffset:u,strokeWidth:r,d:p.map(({p1:w,p2:x})=>`M ${w.x} ${w.y} L ${x.x} ${x.y}`).join(" ")},`${q}-${r}-${t}-${u}`))})});var n6=class a extends $5{static j(b){P(b,{t5:M5,jPa:M5})}render(){var b;const {w0a:c,...d}=this.props,e=this.props.sheet;return Y5("div",{ref:this.mMa,className:E5("ZTz_iA","ltr"===e.direction?"TA4X7w":"WvuqMw"),children:[(null===c||void 0===c?void 0:c.PUa)&&C5(m6,{...d,sheet:e,range:c.PUa.range,$t:!0,au:!0,className:"_0C8M3w",C3:this.t5}),(null===c||void 0===c?void 0:c.Peb)&&C5(m6,{...d,sheet:e,range:c.Peb.range,$t:!1,au:!0,className:"_7n44yg",C3:this.t5}),(null===c||void 0===c?void 0:c.i2a)&&C5(m6,
{...d,sheet:e,range:c.i2a.range,$t:!0,au:!1,className:"fF5r6w",C3:this.t5}),C5(m6,{...d,sheet:e,range:null===c||void 0===c?void 0:null===(b=c.meb)||void 0===b?void 0:b.range,$t:!1,au:!1,className:"llILYw",C3:this.jPa})]})}componentDidMount(){const b=L5(()=>{var c=this.props,d=c.scaleFactor;c=c.sheet;const e=this.mMa.current;e&&(d=d?d.get():1,e.style.width=`${c.width*d}px`,e.style.height=`${c.height*d}px`)});__c.vc(this,[b])}get t5(){return{type:"excluded"}}get jPa(){return{type:"hidden",isVisible:this.GVa}}constructor(...b){super(...b);
a.j(this);this.mMa=Py();this.GVa=(c,d)=>{var e;const f=this.props.sheet;var g=this.props.w0a;g=null===g||void 0===g?void 0:null===(e=g.meb)||void 0===e?void 0:e.range;return null==g?!0:0>=f.layout.cols.hg(g.fc,c)&&0>=f.layout.cols.hg(c,g.Yc)&&0>=f.layout.rows.hg(g.rc,d)&&0>=f.layout.rows.hg(d,g.rd)}}};n6=d6([Lc],n6);
var m6=class a extends $5{static j(b){P(b,{kMa:M5})}get kMa(){const b=this.props.viewport,c=this.props.$t,d=this.props.au;return null==b||!c&&!d?b:M5(()=>{const e=__c.$t(b.get());return __c.St({top:d?0:e.top,left:c?0:e.left,width:e.width,height:e.height})})}render(){const b=this.props.sheet,c=this.props.range,d=this.props.C3,e=this.props.XT,f=this.props.$t,g=this.props.au;return Y5("div",{ref:this.Eoa,className:E5("i0YQww",this.props.className),children:[C5("div",{ref:this.RIa,className:"vUKoKg",
children:C5("div",{ref:this.SIa,children:C5(o6,{sheet:b,viewport:this.kMa,bounds:"hidden"===(null===d||void 0===d?void 0:d.type)?void 0:c,FX:"hidden"===(null===d||void 0===d?void 0:d.type)?d.isVisible:void 0,ds:this.props.ds,wB:this.props.wB,nda:this.props.nda,Yh:this.props.Yh,tV:this.props.tV,scaleFactor:this.props.scaleFactor})})}),e&&C5(e,{sheet:b,range:c,$t:f,au:g})]})}componentDidMount(){const b=L5(()=>{var h=this.props,k=h.scaleFactor,l=h.sheet;const m=h.range;var n=this.Eoa.current;const p=
this.RIa.current;h=this.SIa.current;k=k?k.get():1;const q=m?l.ra(m.Yc)+m.Yc.width-l.ra(m.fc):l.width,r=m?l.ua(m.rd)+m.rd.height-l.ua(m.rc):l.height;n&&(n.style.width=`${q*k}px`,n.style.height=`${r*k}px`);p&&(p.style.width=`${q*k}px`,p.style.height=`${r*k}px`);n="rtl"===l.direction;n=m?l.ra(m.fc)*k*(n?1:-1):0;l=m?-l.ua(m.rc)*k:0;h&&(h.style.transform=`translate(${n}px, ${l}px)`)}),c=this.props.sheet;var d=this.props.n6;const e=this.props.$t,f=this.props.au,g=e||f?null===d||void 0===d?void 0:d(c,e,
f):void 0;d=L5(()=>{const h=this.Eoa.current;if(null!=h){var k=e||f?"sticky":"relative",l=f?"0px":"unset",m=e?"0px":"unset",n=e?"0px":"unset",p="rtl"===c.direction;if(null==g)h.style.position=k,h.style.top=l,h.style.left=p?"unset":m,h.style.right=p?n:"unset";else{const x=g.get();var q;h.style.position=null!==(q=x.position)&&void 0!==q?q:k;var r;h.style.top=null!==(r=x.top)&&void 0!==r?r:l;var t;h.style.left=p?"unset":null!==(t=x.left)&&void 0!==t?t:m;var u;h.style.right=p?null!==(u=x.right)&&void 0!==
u?u:n:"unset";var w;h.style.transform=null!==(w=x.transform)&&void 0!==w?w:"unset"}}});__c.vc(this,[b,d])}constructor(...b){super(...b);a.j(this);this.Eoa=Py();this.RIa=Py();this.SIa=Py()}};m6=d6([Lc],m6);
var LJb=class{constructor(){this.cells=new Map;this.Mpa=(a,b,c)=>{let d=this.cells.get(a);null==d&&(d=new Map,this.cells.set(a,d));d.set(b,c);return()=>{const e=this.cells.get(a);null!=e&&(null===e||void 0===e?void 0:e.get(b))===c&&(e.delete(b),0===e.size&&this.cells.delete(a))}};this.getContentSize=(a,b)=>{var c,d;return null===(d=this.cells.get(a))||void 0===d?void 0:null===(c=d.get(b))||void 0===c?void 0:c.Kya}}},o6=class a extends $5{static j(b){P(b,{BI:c6.shallow,pp:M5,bounds:M5,lB:M5({equals:U5.shallow}),
Dta:M5({equals:U5.shallow}),Mwa:b6,r4:b6.bound})}get pp(){var b;const c=null===(b=this.props.ds)||void 0===b?void 0:b.get();if(null!=c&&0!==c.length)return new __c.QF(c)}render(){var b;return Y5("div",{ref:rJb(this.xd,null===(b=this.pp)||void 0===b?void 0:b.Qk),children:[C5("div",{ref:this.Xfa,className:"_5YlOqQ"}),C5("div",{ref:this.Zfa,className:"_XCmKw"}),this.BI.map(c=>c.R9a),C5(this.oda,{})]})}componentDidMount(){const b=T5(()=>[this.props.sheet,this.Dta,this.lB],([e,f,g],h)=>{[h]=h||[];e!==
h&&this.UVa();this.Mwa(f,g)},{fireImmediately:!0}),c=L5(()=>{var e=this.props,f=e.scaleFactor;e=e.sheet;const g=this.xd.current;g&&(f=f?f.get():1,g.style.width=`${e.width*f}px`,g.style.height=`${e.height*f}px`)}),d=this.BI.map(e=>iJb(e));__c.vc(this,[c,b,...d])}get bounds(){const b=this.props.sheet,c=this.props.bounds;var d,e,f,g;return{fc:null!==(d=null===c||void 0===c?void 0:c.fc)&&void 0!==d?d:b.layout.cols.first(),Yc:null!==(e=null===c||void 0===c?void 0:c.Yc)&&void 0!==e?e:b.layout.cols.last(),
rc:null!==(f=null===c||void 0===c?void 0:c.rc)&&void 0!==f?f:b.layout.rows.first(),rd:null!==(g=null===c||void 0===c?void 0:c.rd)&&void 0!==g?g:b.layout.rows.last()}}get lB(){const b=this.props.sheet;var c=this.props.scaleFactor,d=this.props.viewport,e=null===d||void 0===d?void 0:d.get();if(e&&(0>=e.height||0>=e.width))return new Map;d=this.bounds;c=c.get();var f=500*c;const g=e?e.tl.y-f:d.rc?b.ua(d.rc):0;e=e?e.br.y+f:d.rd?b.ua(d.rd)+d.rd.height:0;f=new Map;for(let h=d.rc;null!=h&&null!=d.rd&&0>=
b.layout.rows.hg(h,d.rd);h=b.layout.rows.next(h)){const k=b.ua(h);if(!(k+h.height<g)){if(k>e)break;f.set(h,k*c)}}return f}get Dta(){const b=this.props.sheet;var c=this.props.scaleFactor,d=this.props.viewport,e=null===d||void 0===d?void 0:d.get();if(e&&(0>=e.height||0>=e.width))return new Map;d=this.bounds;c=c.get();var f=100*c;const g=e?e.tl.x-f:d.fc?b.ra(d.fc):0;e=e?e.br.x+f:d.Yc?b.ra(d.Yc)+d.Yc.width:0;f=new Map;for(let h=d.fc;null!=h&&null!=d.Yc&&0>=b.layout.cols.hg(h,d.Yc);h=b.layout.cols.next(h)){const k=
b.ra(h);if(!(k+h.width<g)){if(k>e)break;f.set(h,k*c)}}return f}UVa(){const b=C(this.Xfa.current),c=C(this.Zfa.current);b.innerHTML="";c.innerHTML="";this.zta.length=0;this.BI.length=0}Mwa(b,c){const d=C(this.Xfa.current),e=C(this.Zfa.current),f=[],g=new Map;for(const h of this.zta)c.has(h.va)?g.set(h.va,h):f.push(h);for(const [h,k]of c)c=g.get(h)||f.pop(),c||(c=new MJb(this.r4,h),d.appendChild(c.z3),e.appendChild(c.B3),this.zta.push(c)),c.update(k,h,b);for(const h of f)h.hide()}r4(b,c){const d=this.props.tV,
e=this.props.sheet,f=this.props.FX;b=new NJb(this.props.wB,this.props.Yh,d(b,c),e,b,c,f,this.j4.Mpa);__c.vc(this,iJb(b));this.BI.push(b);return b}constructor(...b){super(...b);a.j(this);this.xd=Py();this.Xfa=Py();this.Zfa=Py();this.zta=[];this.BI=[];this.j4=new LJb;this.dfb=M5(()=>[...this.lB.keys()].sort((c,d)=>this.props.sheet.layout.rows.hg(c,d)),{equals:__c.js()});this.afb=M5(()=>[...this.Dta.keys()].sort((c,d)=>this.props.sheet.layout.cols.hg(c,d)),{equals:__c.js()});this.oda=G5(()=>C5(this.props.nda,
{lB:this.dfb,bfb:this.afb,R0a:this.j4.getContentSize}))}};o6=d6([Lc],o6);
var MJb=class{static j(a){P(a,{update:b6})}update(a,b,c){[this.z3,this.B3].forEach(d=>{d.style.transform=`translateY(${a}px)`;d.classList.add("FPpqvg")});this.va=b;for(const [d]of c)c=this.BI.get(d),c||(c=this.r4(d,b),this.BI.set(d,c),this.z3.appendChild(c.Wfa),this.B3.appendChild(c.sO)),c.update(b)}hide(){[this.z3,this.B3].forEach(a=>{a.style.transform="translate(-1000px, -1000px) scale(0)"})}constructor(a,b){MJb.j(this);this.r4=a;this.va=b;this.z3=document.createElement("div");this.B3=document.createElement("div");
this.BI=new Map}},NJb=class{static j(a){P(a,{i4:c6.ref,va:c6.ref,update:b6,Mt:M5,attrs:M5.struct,FX:M5,renderer:M5,Kya:M5.struct})}update(a){a!==this.va&&(this.va=a,this.Zaa.va=a,this.Rha&&this.Rha(),this.Rha=this.Mpa(this.va,this.col,this))}get R9a(){return this.i4}get Mt(){const a=this.sheet.layout.cells.get(this.va,this.col);if(!a||a.span.rc===this.va&&a.span.fc===this.col)return a?a.ref:void 0}get attrs(){return this.sheet.layout.attrs.get(bh({Ci:0,textAlign:0,direction:0}),this.va,this.col)||
{}}get FX(){return null!=this.isVisible?this.isVisible(this.col,this.va):!0}get renderer(){if(this.FX){var a=this.Mt;if(a&&(a.content.ref||a.Fa.ref))return this.wB({context:{va:this.va,col:this.col,sheet:this.sheet,attrs:this.attrs},Lu:this.ona,Yh:this.Yh})}}get Kya(){this.Lya.reportObserved();var a=oJb(()=>this.renderer);if(a&&(a="react"===a.type?this.uZ:this.gC,0!==a.childNodes.length&&(a=a.childNodes[0],a instanceof HTMLElement)))return{width:a.clientWidth,height:a.clientHeight}}constructor(a,
b,c,d,e,f,g,h){NJb.j(this);var k,l,m,n,p,q;this.wB=a;this.Zaa=c;this.sheet=d;this.col=e;this.isVisible=g;this.Mpa=h;this.Wfa=document.createElement("div");this.sO=document.createElement("div");this.FF=document.createElement("div");this.gC=document.createElement("div");this.uZ=document.createElement("div");this.Lya=nJb("content size atom");this.ona=b6(()=>this.Lya.reportChanged());this.va=f;this.Wfa.className="_2JFriw";this.sO.className="imy9ug";this.FF.className=E5("pDMp7w",{_0yZ6Qg:"text3"!==(null===
(l=this.Mt)||void 0===l?void 0:null===(k=l.content.ref)||void 0===k?void 0:k.type),qhF5uA:"text3"!==(null===(n=this.Mt)||void 0===n?void 0:null===(m=n.content.ref)||void 0===m?void 0:m.type)&&"text2"!==(null===(q=this.Mt)||void 0===q?void 0:null===(p=q.content.ref)||void 0===p?void 0:p.type)});this.gC.className="_30B9pw";this.FF.appendChild(this.gC);this.sO.appendChild(this.FF);this.uZ.className="G7zH2w";this.Rha=h(this.va,this.col,this);this.Yh=r=>C5(b,{...r,Lu:this.ona})}};var V5=class extends $5{render(){const a=this.props.sheet,b=this.props.ds,c=this.props.n6,d=this.props.wB,e=this.props.Jd,f=this.props.Yh,g=this.props.viewport,h=this.props.XT;return C5("div",{className:E5("SNkrHw","ltr"===a.direction?"TA4X7w":"WvuqMw"),...e,children:C5(n6,{wB:d,Yh:f,nda:this.oda,tV:this.tV,sheet:a,ds:b,n6:c,scaleFactor:this.scaleFactor,viewport:g,XT:h})})}get scaleFactor(){return this.props.scaleFactor?this.props.scaleFactor:M5(()=>1)}constructor(...a){super(...a);this.oda=G5(b=>
C5(KJb,{...b,sheet:this.props.sheet,scaleFactor:this.scaleFactor,Zka:this.props.Zka}));this.tV=(b,c)=>new __c.RCa(this.props.ey,this.props.sheet,b,c,this.scaleFactor,this.Mz,this.Qz);this.Mz=(b,c)=>{var d,e;return null===(d=(e=this.props).Mz)||void 0===d?void 0:d.call(e,this.props.sheet,b,c)};this.Qz=(b,c)=>{var d,e;return null===(d=(e=this.props).Qz)||void 0===d?void 0:d.call(e,this.props.sheet,b,c)}}};V5=d6([Lc],V5);__c.WCa={f3a:function(a){const b=a.Fm,c=a.Rd,d=a.Nc,e=a.dn,f=a.o_,g=a.ey,h=a.WT;CIb({$x:a.$x,Pe:a.Pe,$cb:a.oM});const k=kJb({wB:h,o_:f,ey:g});b.Hda=VIb({rr:k});c.pda=JIb({rr:k});({FSa:a}=SIb({rr:k,Ce:e(),jMa:new BJb}));d.Uo.Gda=a;const {OQa:l,PQa:m,NQa:n}=IIb();return{iva:G5(p=>C5(sJb,{...p,rr:k,ESa:l,GSa:m,CSa:n,Yh:tJb}))}}};
}).call(self, self._fe4d99ebe0d2d259646a80d250150d47);}

}])
//# sourceMappingURL=sourcemaps/dd0acf6d97dda0a0.js.map